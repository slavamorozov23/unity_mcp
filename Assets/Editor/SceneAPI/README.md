# Unity Scene API - Модульная архитектура

Этот проект был разделен на несколько модулей для улучшения читаемости, поддержки и расширяемости кода.

## Структура файлов

### Основные файлы:

#### 1. `UnitySceneAPIWindow.cs` (главный файл)
- **Назначение**: Основное окно Unity Editor для управления API сервером
- **Функции**: 
  - GUI интерфейс для запуска/остановки сервера
  - Управление портом
  - Обработка событий компиляции Unity
  - Сохранение состояния сервера

#### 2. `UnitySceneAPIServer.cs`
- **Назначение**: HTTP сервер для обработки API запросов
- **Функции**:
  - Запуск и остановка HTTP listener
  - Обработка входящих HTTP запросов
  - Маршрутизация запросов к обработчику API
  - Управление потоками

#### 3. `SceneAPIHandler.cs`
- **Назначение**: Главный координатор API запросов
- **Функции**:
  - Делегирование запросов специализированным обработчикам
  - Маршрутизация по типам операций
  - Централизованная обработка ошибок

### Утилитные классы:

#### 4. `ComponentUtilities.cs`
- **Назначение**: Утилиты для работы с компонентами Unity
- **Функции**:
  - Получение свойств компонентов через SerializedProperty
  - Установка значений свойств компонентов
  - Конвертация различных типов Unity в JSON и обратно

#### 5. `GameObjectUtilities.cs`
- **Назначение**: Утилиты для работы с GameObject'ами Unity
- **Функции**:
  - Поиск объектов по пути в иерархии
  - Получение данных объектов для JSON сериализации
  - Работа с Transform компонентами

#### 6. `MainThreadDispatcher.cs`
- **Назначение**: Диспетчер для выполнения операций в главном потоке Unity
- **Функции**:
  - Очередь действий для выполнения в главном потоке
  - Инициализация и очистка диспетчера
  - Безопасное выполнение Unity API из других потоков

### Специализированные обработчики (папка Handlers/):

#### 7. `SceneHandler.cs`
- **Назначение**: Обработчик операций со сценами
- **Функции**:
  - Получение иерархии сцены
  - Открытие сцен
  - Управление build settings

#### 8. `GameObjectHandler.cs`
- **Назначение**: Обработчик операций с GameObject'ами
- **Функции**:
  - Создание новых объектов
  - Удаление объектов
  - Работа с иерархией объектов

#### 9. `ComponentHandler.cs`
- **Назначение**: Обработчик операций с компонентами
- **Функции**:
  - Получение списка компонентов объекта
  - Добавление/удаление компонентов
  - Модификация свойств компонентов

## Преимущества новой архитектуры

1. **Разделение ответственности**: Каждый класс отвечает за свою область функциональности
2. **Легкость поддержки**: Изменения в одной области не влияют на другие
3. **Расширяемость**: Легко добавлять новые API методы или изменять существующие
4. **Читаемость**: Код стал более структурированным и понятным
5. **Тестируемость**: Каждый модуль можно тестировать независимо
6. **Модульность**: Специализированные обработчики в отдельной папке

## API Endpoints

### Сцены
- `GET /scene` - Получить иерархию активной сцены
- `POST /scene/open` - Открыть сцену
- `GET /build/scenes` - Получить список сцен в build settings
- `POST /build/scenes/add` - Добавить сцену в build settings
- `DELETE /build/scenes/remove` - Удалить сцену из build settings

### GameObject'ы
- `POST /objects/create` - Создать новый GameObject
- `DELETE /objects/delete` - Удалить GameObject

### Компоненты
- `GET /objects/components` - Получить компоненты объекта
- `POST /objects/components/add` - Добавить компонент
- `PUT /objects/components/modify` - Изменить свойства компонента
- `DELETE /objects/components/remove` - Удалить компонент

## Использование

1. Откройте Unity Editor
2. Перейдите в меню `Tools > Scene API Server`
3. Настройте порт (по умолчанию 8080)
4. Нажмите "Start Server"
5. API будет доступен по адресу `http://localhost:8080`

## Namespace

Все классы находятся в namespace `SceneAPI`, а специализированные обработчики в `SceneAPI.Handlers` для лучшей организации кода.

## Архитектурные решения

- **Паттерн Делегирования**: Главный обработчик делегирует работу специализированным классам
- **Разделение по функциональности**: Каждый тип операций имеет свой обработчик
- **Утилитные классы**: Общая функциональность вынесена в отдельные утилиты
- **Четкая структура папок**: Обработчики организованы в отдельную подпапку